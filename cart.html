<!DOCTYPE html>
<html lang="en">

<head>

	<!--Meta Tags-->
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>購物車</title>


	<!-- Bootstrap CSS -->
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/myall.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
	<link rel="stylesheet" href="css/all.min.css">

	<!--Stylesheets-->
	<link rel="stylesheet" href="css/superfish.css" type="text/css" media="all" />
	<link rel="stylesheet" href="css/prettyPhoto.css" type="text/css" media="all" />
	<link type="text/css" href="css/jqueryui/jquery.ui.datepicker.css" rel="stylesheet" />
	<link rel="stylesheet" href="style.css" type="text/css" media="all" />
	<link rel="stylesheet" href="css/responsive.css" type="text/css" media="all" />
	<link rel="stylesheet" href="css/flexslider.css" type="text/css" media="all" />
	<link rel="stylesheet" href="css/colours/green.css" type="text/css" media="all" />

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link
		href="https://fonts.googleapis.com/css2?family=Allura&family=Roboto:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap"
		rel="stylesheet">

	<link
		href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic,800,800italic'
		rel='stylesheet' type='text/css' />
	<link href='http://fonts.googleapis.com/css?family=Cardo:400,400italic,700' rel='stylesheet' type='text/css' />

	<!--Favicon-->
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
	<!-- animate.css -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
	<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
	<link rel="stylesheet" href="css/myall.css?v=1.0">
</head>

<body>
	<!-- BEGIN .wrapper -->
	<div class="wrapper">

		<!-- 上方登入資訊條 -->
		<div class="topbar clearfix">

			<!-- BEGIN .social-icons -->
			<ul class="social-icons">
				<li><a href="#"><span id="twitter_icon"></span></a></li>
				<li><a href="#"><span id="facebook_icon"></span></a></li>
				<li><a href="#"><span id="googleplus_icon"></span></a></li>
				<li><a href="#"><span id="youtube_icon"></span></a></li>
				<!-- END .social-icons -->
			</ul>

			<!-- BEGIN .topbar-right -->
			<div class="topbar-right clearfix">
				<ul class="clearfix">
					<span class=" fw-900 ms-3">當前會員:
						<span class="txt20 fw-900" id="s02_login_username" style="margin-right: 20px;">未登錄</span>
					</span>
					<!-- 移除了 button，將其功能轉移到 a 標籤 -->
					<li class="">
						<a href="checkout.html" data-bs-toggle="modal" data-bs-target="#loginModal" id="s02_login_btn"
							class="btn"> <span class="icon-placeholder"></span>登入</a>
					</li>
					<!-- 移除了 button，將其功能轉移到 a 標籤 -->
					<li class="">
						<a href="my-account.html" data-bs-toggle="modal" data-bs-target="#registerModal"
							id="s02_register_btn" class="btn">註冊</a>
					</li>
					<!-- 移除了 button，將其功能轉移到 a 標籤 -->
					<li class="">
						<a href="project-spa.html" id="s02_logout_btn" class="btn d-none">登出</a>
					</li>
					<li class="">
						<a href="my-member.html">個人訂單查詢</a>
					</li>
				</ul>

				<div class="cart-top" style="height: 50px;">
					<p><a href="cart.html" style="text-align: center;">購物車</a></p>
				</div>
				<!-- END .topbar-right -->
			</div>

			<!-- END .topbar -->
		</div>

		<!-- 大標題 園桌武士-->
		<div id="s01" style="height:200px; display: flex; align-items: center; justify-content: center;"
			class="topbar clearfix">
			<h1 class="text-center align-content-center">
				園桌武士 <span class="txt30">園藝造景工坊</span>
			</h1>
		</div>

		<!-- 選單 -->
		<div class="bg10" id="s02">
			<div class="banner">
				<nav class="bg20 mt-4" style="height:70px;">
					<ul>
						<li><a href="project-spa.html" class="bgbtn10">首頁</a></li>
						<li class="dropdown"><a href="" class="bgbtn10">燈飾</a>
							<ul class="dropdown-menu">
								<li><a href="product-single1.html">燈飾1</a></li>
								<li><a href="product-single2.html">燈飾2</a></li>
								<li><a href="product-single3.html">燈飾3</a></li>
							</ul>
						</li>
						<li class="dropdown"><a href="" class="bgbtn10">戶外桌椅</a>
							<ul class="dropdown-menu">
								<li><a href="product-single4.html">戶外桌椅1</a></li>
								<li><a href="product-single5.html">戶外桌椅2</a></li>
								<li><a href="product-single6.html">戶外桌椅3</a></li>
							</ul>
						</li>
						<li class="dropdown"><a href="" class="bgbtn10">園藝植物</a>
							<ul class="dropdown-menu">
								<li><a href="product-single7.html">園藝植物1</a></li>
								<li><a href="product-single8.html">園藝植物2</a></li>
								<li><a href="product-single9.html">園藝植物3</a></li>
							</ul>
						</li>
						<li><a href="project-aboutus.html" class="bgbtn10">關於我們</a></li>
						<li class="dropdown"><a href="" class="bgbtn10 d-none" id="member_manage">管理</a>
							<ul class="dropdown-menu">
								<li><a href="member.html">會員管理</a></li>
								<li><a href="project-contact.html">產品管理</a></li>
							</ul>
						</li>
					</ul>
				</nav>
			</div>
		</div>






		<!-- 以上所有分頁通用 ----------------------------------------------------------------------------------------------->


		<div id="page-header">
			<img src="images/page-header1.jpg" alt="" />
		</div>

		<!-- BEGIN .section -->
		<div class="section page-content clearfix">

			<h2 class="page-title">購物車</h2>

			<form method="post" action="#">

				<div class="tag-title-wrap clearfix">
					<h4 class="tag-title">購物車清單</h4>
				</div>

				<table width="100%" class="account-table">
					<thead>
						<tr>
							<th>商品名稱 #</th>
							<th>數量</th>
							<th>單價</th>
							<th>總計</th>
							<th>清除</th>
						</tr>
					</thead>
					<tbody id="cartItems">
						<!-- <tr>
							<td data-title=">商品名稱">A1</td>
							<td data-title="數量">12</td>
							<td data-title="總計">$149.97</td>
							<td data-title="清除"><input type="checkbox" name="remove-item" value="0123" /></td>
						</tr> -->
					</tbody>
				</table>
				<!-- BEGIN .clearfix -->
				<div class="cart-options clearfix">

					<div class="coupon-form clearfix fl">
						<input type="text" class="coupon-code" name="coupon-code" class="text_input" value="" />
						<input class="button2 fr" style="margin: 2px 0 0 10px;" type="button" value="優惠券 &raquo;"
							name="submit" />
					</div>

					<!-- END .clearfix -->
				</div>

			</form>

			<hr />

			<div class="form-third">

				<div class="tag-title-wrap clearfix">
					<h4 class="tag-title">總共</h4>
				</div>

				<table width="100%" class="account-table">
					<tbody>
						<tr>
							<td><strong>商品費用</strong></td>
							<td id="productCost">$0.00</td> <!-- 設置商品費用的 ID -->
						</tr>
						<tr>
							<td><strong>運費</strong></td>
							<td id="shippingCost">優惠期間免費</td> <!-- 設置運費的 ID -->
						</tr>
						<tr>
							<td><strong>總共費用</strong></td>
							<td id="totalCost">$0.00</td> <!-- 設置總共費用的 ID -->
						</tr>
					</tbody>
				</table>

				<input class="button2 fr" style="margin: 2px 0 0 0;" type="submit" value="前往結帳 &raquo;" name="submit"
					id="checkout">

			</div>

			<!-- END .section -->
		</div>

		<!-- BEGIN #footer -->
		<div id="footer">

			<ul class="columns-4 clearfix">


				<!-- BEGIN .widget -->
				<div class="row">
					<div class="widget-title clearfix">
						<h2>客服資訊</h2>
					</div>

					<li class="contact-phone mb-2">
						<p>電話:+44 0123456789</p>
					</li>

					<li class="contact-mail">
						<p>信箱:12345678@gmail.com</p>
					</li>


					<!-- END .widget -->
				</div>



			</ul>

			<!-- END #footer -->
		</div>

		<div id="footer-bottom" class="clearfix">

			<div class="fl">

				<ul>
					<li><a href="index.html">Home</a></li>
					<li><a href="blog.html">Blog</a></li>
					<li><a href="contact.html">Contact Us</a></li>
					<li><a href="products.html">Products</a></li>
				</ul>

			</div>

			<div class="fr">
				<img src="images/payment-methods.png" alt="Payment Methods" />
			</div>

		</div>

		<!-- END .wrapper -->
	</div>

	<!-- END body -->
	<script src="js/bootstrap.bundle.min.js"></script>
	<script src="js/jquery-3.7.1.min.js"></script>
	<script src="https://unpkg.com/counterup2@2.0.2/dist/index.js">	</script>
	<script src="js/wow.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<!-- 登入功能 -->
	<script>
		var flag_username = false;
		var flag_password = false;
		var flag_re_password = false;
		var flag_email = false;
		var flag_chk = false;


		$(function () {
			// //wow
			// new WOW().init();
			// //counter up
			// //数字跳动
			// const counterUp = window.counterUp.default

			// const callback = entries => {
			//     entries.forEach(entry => {
			//         const el = entry.target
			//         if (entry.isIntersecting && !el.classList.contains('is-visible')) {
			//             counterUp(el, {
			//                 duration: 2000,
			//                 delay: 16,
			//             })
			//             el.classList.add('is-visible')
			//         }
			//     })
			// }
			// //这两行是重点
			// const IO = new IntersectionObserver(callback, { threshold: 1 })

			// const el01 = document.querySelector('.counter01')
			// IO.observe(el01)

			// const el02 = document.querySelector('.counter02')
			// IO.observe(el02)

			// const el03 = document.querySelector('.counter03')
			// IO.observe(el03)

			// const el04 = document.querySelector('.counter04')
			// IO.observe(el04)

			//確認uid是否存在且合法
			if (getCookie("Uid01") != "") {
				//將uid01傳遞至後端api確認是否合法
				var dataJSON = {};
				dataJSON["Uid01"] = getCookie("Uid01");
				console.log(JSON.stringify(dataJSON));

				$.ajax({
					type: "POST",
					url: "uid-check-api.php",
					data: JSON.stringify(dataJSON),
					dataType: "json",
					success: showdata_check_uid,
					error: function () {
						alert("error-uid-check-api.php");
					}
				});
			} else {
				alert("尚未登入，請登入使用附加功能");
				location.href = "project-spa.html";
			}



			// 註冊功能

			// 監聽username
			$("#registerModal_username").bind("input propertychange", function () {
				if ($(this).val().length > 2 && $(this).val().length < 9) {

					var dataJSON = {};
					dataJSON["username"] = $("#registerModal_username").val();
					console.log(JSON.stringify(dataJSON));
					//傳送至後端API\

					$.ajax({
						type: "POST",
						url: "member-check-api.php",
						data: JSON.stringify(dataJSON),
						dataType: "json",
						success: showdata_checkuni,
						error: function () {
							alert("error-member-check-api.php");
						}
					});
				} else {
					// 不符合規定
					$(this).removeClass("is-valid");
					$(this).addClass("is-invalid");
					flag_username = false;
				}
			});

			// 監聽password
			$("#registerModal_password").bind("input propertychange", function () {
				if ($(this).val().length > 2 && $(this).val().length < 9) {
					// 符合規定
					$(this).removeClass("is-invalid");
					$(this).addClass("is-valid");
					flag_password = true;
				} else {
					// 不符合規定
					$(this).removeClass("is-valid");
					$(this).addClass("is-invalid");
					flag_password = false;
				}

				if ($(this).val() !== $("#registerModal_re_password").val()) {

					$("#registerModal_re_password").removeClass("is-valid");
					$("#registerModal_re_password").addClass("is-invalid");
					flag_re_password = false;
				}
				if ($(this).val() == $("#registerModal_re_password").val()) {

					$("#registerModal_re_password").removeClass("is-invalid");
					$("#registerModal_re_password").addClass("is-valid");
					flag_re_password = true;
				}
			});

			//監聽registerModal_re_password
			$("#registerModal_re_password").bind("input propertychange", function () {
				if ($(this).val() == $("#registerModal_password").val()) {
					//符合規定
					$(this).removeClass("is-invalid");
					$(this).addClass("is-valid");
					flag_re_password = true;
				} else {
					//不符合規定
					$(this).removeClass("is-valid");
					$(this).addClass("is-invalid");
					flag_re_password = false;
				}
			});

			//監聽username
			$("#registerModal_email").bind("input propertychange", function () {
				if ($(this).val().length > 2 && $(this).val().length < 16) {
					//符合規定
					$(this).removeClass("is-invalid");
					$(this).addClass("is-valid");
					flag_email = true;
				} else {
					//不符合規定
					$(this).removeClass("is-valid");
					$(this).addClass("is-invalid");
					flag_email = false;
				}
			});

			//同意按鈕
			$("#registerModal_chk").change(function () {
				if ($(this).is(":checked")) {
					//打勾 
					$(this).removeClass("is-invalid");
					$(this).addClass("is-valid");
					flag_chk = true;
				} else {
					//未打勾
					$(this).removeClass("is-valid");
					$(this).addClass("is-invalid");
					flag_chk = false;
				}
			});

			//註冊按鈕監聽
			$("#registerModal_ok_btn").click(function () {
				if (flag_username && flag_password && flag_re_password && flag_email && flag_chk) {

					var dataJSON = {};
					dataJSON["username"] = $("#registerModal_username").val();
					dataJSON["password"] = $("#registerModal_password").val();
					dataJSON["email"] = $("#registerModal_email").val();

					console.log(JSON.stringify(dataJSON));

					$.ajax({
						type: "POST",
						url: "member-create-api.php",
						data: JSON.stringify(dataJSON),
						contentType: "application/json", // 添加這一行
						dataType: "json",
						success: showdata_register,
						error: function (xhr, status, error) {
							console.error("AJAX Error: " + status + " - " + error);
							alert("Error: " + error);
						}
					});

				} else {
					// alert("欄位有錯請修正!");
					if (flag_chk == false) {
						Swal.fire({
							title: "請按同意!",
							showDenyButton: false,
							showCancelButton: false,
							confirmButtonText: "確認",
							denyButtonText: `Don't save`
						}).then((result) => {
							/* Read more about isConfirmed, isDenied below */
							if (result.isConfirmed) {
								Swal.fire("確認", "", "success");
							} else if (result.isDenied) {
								Swal.fire("Changes are not saved", "", "info");
							}
						});
					}

				}
			});

			//**********************************登入功能***********************************************
			//登入按鈕監聽
			$("#loginModal_ok_btn").click(function () {
				if ($("#loginModal_username").val() != "" && $("#loginModal_password").val() != "") {
					//帳號密碼都有輸入
					//傳遞登入資料至後端API 執行登入行為
					//{"username":"owner01", "password":"123456"}
					var dataJSON = {};
					dataJSON["username"] = $("#loginModal_username").val();
					dataJSON["password"] = $("#loginModal_password").val();

					console.log(JSON.stringify(dataJSON));

					$.ajax({

						type: "POST",
						url: "member-login-api.php",
						data: JSON.stringify(dataJSON),
						dataType: "json",
						success: showdata_login,
						error: function () {
							alert("error-member-login-api.php");
						}
					});

				} else {
					//帳號密碼都有空白欄位
					alert("帳號密碼有空白欄位");
				}
			});


			//登出按鈕監聽
			$("#s02_logout_btn").click(function () {
				setCookie("Uid01", "", 7);
				location.href = "project-spa.html";
			});

		}); //end fun

		//註冊時檢測帳號是否重複
		function showdata_checkuni(data) {
			console.log(data);
			if (data.state) {
				$("#registerModal_username").removeClass("is-invalid");
				$("#registerModal_username").addClass("is-valid");
				flag_username = true;
			} else {
				$("#registerModal_username").removeClass("is-valid");
				$("#registerModal_username").addClass("is-invalid");
				flag_username = false;
			}
		}
		//註冊function
		function showdata_register(data) {
			console.log(data);
			if (data.state) {
				alert(data.message);
				location.href = "project-spa.html";
			} else {
				alert(data.message);
			}
		}
		//登入function
		function showdata_login(data) {
			console.log(data);
			if (data.state) {
				if (data.data.State == "1") {
					alert(data.message);
					//loginModal隱藏
					$("#loginModal").modal("hide");
					//顯示登入帳號
					$("#s02_login_username").text();
					$("#s02_login_username").text(data.data.Username);
					//隱藏登入與註冊按鈕
					$("#s02_login_btn").addClass("d-none");
					$("#s02_register_btn").addClass("d-none");
					//顯示登出按鈕
					$("#s02_logout_btn").removeClass("d-none");
					$("member_manage").removeClass("d-none");


					// 顯示高級功能
					$("#s02btn01").removeClass("disabled");
					$("#s02btn02").removeClass("disabled");
					$("#s02btn03").removeClass("disabled");
					$("#s041").removeClass("d-none");
					$("#s042").removeClass("d-none");
				} else {
					alert(data.message + "，你沒資格阿你沒資格!");
					//loginModal隱藏
					$("#loginModal").modal("hide");
					//顯示登入帳號
					$("#s02_login_username").text(data.data.Username);
					//隱藏登入與註冊按鈕
					$("#s02_login_btn").addClass("d-none");
					$("#s02_register_btn").addClass("d-none");
					//顯示登出按鈕
					$("#s02_logout_btn").removeClass("d-none");


				}
				setCookie("Uid01", data.data.Uid01, 7);
			} else {
				alert(data.message);
			}
		}
		//uid檢測function
		function showdata_check_uid(data) {
			console.log(data);
			if (data.state) {
				if (data.data.State == "1") {
					// 更新用戶名稱
					$("#s02_login_username").text(data.data.Username);
					// 隱藏登入與註冊按鈕
					$("#s02_login_btn").addClass("d-none");
					$("#s02_register_btn").addClass("d-none");
					// 顯示登出按鈕
					$("#s02_logout_btn").removeClass("d-none");
					$("member_manage").removeClass("d-none");

					// 顯示vip高級功能
					$("#s02btn01").removeClass("disabled");
					$("#s02btn02").removeClass("disabled");
					$("#s02btn03").removeClass("disabled");
					$("#s041").removeClass("d-none");
					$("#s042").removeClass("d-none");
				} else {
					alert(data.message + "，你沒資格阿你沒資格!");
					$("#s02_login_username").text(data.data.Username);
					// 隱藏登入與註冊按鈕
					$("#s02_login_btn").addClass("d-none");
					$("#s02_register_btn").addClass("d-none");
					// 顯示登出按鈕
					$("#s02_logout_btn").removeClass("d-none");

					//這裡不給顯示高級功能了

					//顯示停權警告畫面 s13
					$("#s13").removeClass("d-none");

				}
			}
		}

		// 以下是cookie都是网上搬来的， 不重要
		function setCookie(cname, cvalue, exdays) {
			const d = new Date();
			d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
			let expires = "expires=" + d.toUTCString();
			document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
		}

		function getCookie(cname) {
			let name = cname + "=";
			let decodedCookie = decodeURIComponent(document.cookie);
			let ca = decodedCookie.split(';');
			for (let i = 0; i < ca.length; i++) {
				let c = ca[i];
				while (c.charAt(0) == ' ') {
					c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
					return c.substring(name.length, c.length);
				}
			}
			return "";
		}
	</script>

	<!-- 購物車 -->
	<script>
		// 全局變數
		let name;
		let cart = [];

		// 當頁面加載時
		$(document).ready(function () {
			// 顯示購物車內容
			displayCart();

			// 確認 uid 是否存在且合法
			if (getCookie("Uid01") != "") {
				var dataJSON = { "Uid01": getCookie("Uid01") };
				$.ajax({
					type: "POST",
					url: "uid-check-api.php",
					data: JSON.stringify(dataJSON),
					dataType: "json",
					success: showdata_check_uid,
					error: function () {
						alert("error-uid-check-api.php");
					}
				});
			}

			// 登入按鈕監聽
			$("#loginModal_ok_btn").click(function () {
				if ($("#loginModal_username").val() != "" && $("#loginModal_password").val() != "") {
					var dataJSON = {
						"username": $("#loginModal_username").val(),
						"password": $("#loginModal_password").val()
					};
					$.ajax({
						type: "POST",
						url: "member-login-api.php",
						data: JSON.stringify(dataJSON),
						dataType: "json",
						success: showdata_login,
						error: function () {
							alert("error-member-login-api.php");
						}
					});
				} else {
					alert("登入錯誤!");
				}
			});

			// 登出按鈕監聽
			$("#s02_logout_btn").click(function () {
				setCookie("Uid01", "", 7);
				location.href = "cart.html";
				clearCart();
			});

			// 結帳按鈕監聽
			$("#checkout").click(function () {
				if (isMemberLoggedIn()) {
					// 彈出確認對話框
					if (confirm("確定要結帳嗎？")) {
						let memberId = name;
						let orderData = {
							memberId: memberId,
							items: cart // 包含購物車內的所有商品
						};

						// 禁用按鈕，避免重複點擊
						$(this).prop('disabled', true);

						$.ajax({
							type: "POST",
							url: "car-create-api.php",
							data: JSON.stringify(orderData),
							dataType: "json",
							success: showdata_car_create,
							error: function () {
								alert("error-car-create-api.php");
							},
							complete: function () {
								// 請求完成後，重新啟用按鈕
								$("#checkout").prop('disabled', false);
							}
						});
					}
				} else {
					alert("請先登入會員！");
				}
			});

			// 頁面加載後執行顯示購物車的函數
			window.onload = displayCart;

			// 監聽 localStorage 的變化
			window.addEventListener('storage', function (event) {
				if (event.key === 'cart') {
					displayCart(); // 重新顯示購物車內容
				}
			});
		});

		function displayCart() {
			cart = JSON.parse(localStorage.getItem('cart')) || []; // 更新全局 cart 變數

			let cartItems = document.getElementById('cartItems');
			let totalCost = 0; // 用於計算總價格
			cartItems.innerHTML = '';
			if (cart.length === 0) {
				cartItems.innerHTML = "<p>購物車為空</p>";
			} else {
				cart.forEach(item => {
					let row = document.createElement('tr');
					let itemTotal = item.quantity * item.price; // 每個商品的總價
					totalCost += itemTotal; // 累計所有商品的總價格
					row.innerHTML = `<td data-name="${item.name}">${item.name}</td>
                             <td data-num="${item.quantity}">${item.quantity}</td>
                             <td data-title="單價">$${item.price.toFixed(2)}</td>
                             <td data-title="總計">$${item.quantity * item.price.toFixed(2)}</td>
                             <td data-title="清除"><button type="button" onclick="removeItem('${item.name}')">移除</button></td>`;
					cartItems.appendChild(row);
				});
				// 更新商品費用和總共費用的 ID
				document.getElementById('productCost').textContent = `$${totalCost.toFixed(2)}`;
				document.getElementById('totalCost').textContent = `$${totalCost.toFixed(2)}`;
			}

		}

		function removeItem(itemName) {
			cart = cart.filter(item => item.name !== itemName); // 更新全局 cart 變數
			localStorage.setItem('cart', JSON.stringify(cart)); // 更新 localStorage
			displayCart(); // 重新渲染購物車
		}

		function isMemberLoggedIn() {
			return getCookie("Uid01") !== "";
		}

		function getCookie(cname) {
			let name = cname + "=";
			let decodedCookie = decodeURIComponent(document.cookie);
			let ca = decodedCookie.split(';');
			for (let i = 0; i < ca.length; i++) {
				let c = ca[i];
				while (c.charAt(0) == ' ') {
					c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
					return c.substring(name.length, c.length);
				}
			}
			return "";
		}

		function clearCart() {
			localStorage.removeItem('cart');
		}

		function showdata_login(data) {
			console.log(data);
			if (data.state) {
				if (data.data.State == "1") {
					alert(data.message);
					$("#loginModal").modal("hide");
					$("#s02_login_username").text(data.data.Username);
					$("#s02_login_btn").addClass("d-none");
					$("#s02_register_btn").addClass("d-none");
					$("#s02_logout_btn").removeClass("d-none");

					$("#s02btn01").removeClass("disabled");
					$("#s02btn02").removeClass("disabled");
					$("#s02btn03").removeClass("disabled");
					$("#s041").removeClass("d-none");
					$("#s042").removeClass("d-none");
				} else {
					alert(data.message + "，你沒資格阿你沒資格!");
					$("#loginModal").modal("hide");
					$("#s02_login_username").text(data.data.Username);
					$("#s02_login_btn").addClass("d-none");
					$("#s02_register_btn").addClass("d-none");
					$("#s02_logout_btn").removeClass("d-none");
				}
				setCookie("Uid01", data.data.Uid01, 7);
			} else {
				alert(data.message);
			}
		}

		function showdata_check_uid(data) {
			console.log(data);
			name = data.data.Username;
			console.log(name);
			if (data.state) {
				if (data.data.State == "1") {
					$("#s02_login_username").text(data.data.Username);
					$("#s02_login_btn").addClass("d-none");
					$("#s02_register_btn").addClass("d-none");
					$("#s02_logout_btn").removeClass("d-none");
					$("#s02btn01").removeClass("disabled");
					$("#s02btn02").removeClass("disabled");
					$("#s02btn03").removeClass("disabled");
					$("#s041").removeClass("d-none");
					$("#s042").removeClass("d-none");
				} else {
					alert(data.message + "，你沒資格阿你沒資格!");
					$("#s02_login_username").text(data.data.Username);
					$("#s02_login_btn").addClass("d-none");
					$("#s02_register_btn").addClass("d-none");
					$("#s02_logout_btn").removeClass("d-none");
					$("#s13").removeClass("d-none");
				}
			}
		}

		function showdata_car_create(data) {
			console.log(data);
			alert(data.message); // 顯示成功或失敗的提示訊息

			// 清空 localStorage 中的購物車資料
			localStorage.removeItem('cart');

			// 清空購物車顯示的內容
			let cartItems = document.getElementById('cartItems');
			cartItems.innerHTML = '<p>購物車為空</p>';

			// 更新商品費用和總共費用
			document.getElementById('productCost').textContent = '$0.00';
			document.getElementById('totalCost').textContent = '$0.00';
			location.href = "cart.html"

		}

		function setCookie(cname, cvalue, exdays) {
			const d = new Date();
			d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
			let expires = "expires=" + d.toUTCString();
			document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
		}

		function getCookie(cname) {
			let name = cname + "=";
			let decodedCookie = decodeURIComponent(document.cookie);
			let ca = decodedCookie.split(';');
			for (let i = 0; i < ca.length; i++) {
				let c = ca[i];
				while (c.charAt(0) == ' ') {
					c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
					return c.substring(name.length, c.length);
				}
			}
			return "";
		}

	</script>

	<!-- 登陸檢測 -->
	<script>
		// 检查是否已设置表示登录状态的cookie
		function checkLoginStatus() {
			var uid = getCookie("Uid01"); // 假设"Uid01"是存储用户登录状态的cookie
			if (!uid) {
				// 如果未设置cookie，即用户未登录
				alert("未登錄!");
				window.location.href = "project-spa.html"; // 重定向到首页
			}
		}

		// 设置cookie的函数
		function setCookie(cname, cvalue, exdays) {
			const d = new Date();
			d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
			let expires = "expires=" + d.toUTCString();
			document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
		}

		// 获取cookie的函数
		function getCookie(cname) {
			let name = cname + "=";
			let decodedCookie = decodeURIComponent(document.cookie);
			let ca = decodedCookie.split(';');
			for (let i = 0; i < ca.length; i++) {
				let c = ca[i];
				while (c.charAt(0) == ' ') {
					c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
					return c.substring(name.length, c.length);
				}
			}
			return "";
		}

		// 页面加载完成后执行检查
		window.onload = function () {
			checkLoginStatus();
		}
	</script>
</body>

</html>